<!DOCTYPE html>

<html lang="en-US">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<title>phyopt | Ricardo Semião</title>
<!-- mathjax math --><script crossorigin="anonymous" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"/>
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="theoretical_framework_files/libs/quarto-html/popper.min.js"></script><script src="theoretical_framework_files/libs/quarto-html/tippy.umd.min.js"></script><link href="theoretical_framework_files/libs/quarto-html/tippy.css" rel="stylesheet"/>
<link href="theoretical_framework_files/libs/quarto-html/light-border.css" rel="stylesheet"/>
<!-- pkgdown --><script src="../pkgdown.js"></script><!-- Personal style and social: --><style>
        @font-face {
            font-display: swap;
            font-family: 'Montserrat';
            font-style: normal;
            font-weight: 400;
            src: url('/assets/fonts/montserrat-v31-latin-regular.woff2') format('woff2');
        }
        @font-face {
            font-display: swap;
            font-family: 'Montserrat';
            font-style: normal;
            font-weight: 700;
            src: url('/assets/fonts/montserrat-v31-latin-700.woff2') format('woff2');
        }
        @font-face {
            font-display: swap;
            font-family: 'Nunito Sans';
            font-style: normal;
            font-weight: 400;
            src: url('/assets/fonts/nunito-sans-v19-latin-regular.woff2') format('woff2');
        }
        @font-face {
            font-display: swap;
            font-family: 'Nunito Sans';
            font-style: italic;
            font-weight: 400;
            src: url('/assets/fonts/nunito-sans-v19-latin-italic.woff2') format('woff2');
        }
        @font-face {
            font-display: swap;
            font-family: 'Nunito Sans';
            font-style: normal;
            font-weight: 700;
            src: url('/assets/fonts/nunito-sans-v19-latin-700.woff2') format('woff2');
        }
    </style>
<link as="font" crossorigin="" href="/assets/fonts/montserrat-v31-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/assets/fonts/montserrat-v31-latin-700.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/assets/fonts/nunito-sans-v19-latin-regular.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/assets/fonts/nunito-sans-v19-latin-700.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="/assets/fonts/nunito-sans-v19-latin-italic.woff2" rel="preload" type="font/woff2"/>
<link href="/assets/global.css" rel="stylesheet"/>
<link href="../assets/rspd_module.css" rel="stylesheet"/>
<link href="/assets/img/icon.webp" rel="icon" type="image/png"/>
<link href="/assets/img/icon.webp" rel="shortcut icon" type="image/png"/>
<meta content="Ricardo Semião e Castro" name="Author"/>
<meta content="Theoretical Framework" property="og:title"/>
<!-- Personal analytics and schema: --><script async="" data-goatcounter="https://ricardo-semiao.goatcounter.com/count" src="//gc.zgo.at/count.js"></script>
</head>
<body class="rssite-external">
<!-- @@site-icons@@ -->
<a class="visually-hidden-focusable" href="#main">Skip to contents</a>
<header id="rssite-header">
<nav aria-label="Main site navigation">
<ul>
<li class="nav-li"><a href="/">Home</a></li>
<li class="nav-li"><a href="/blog">Blog</a></li>
<li class="nav-drop">
<button aria-controls="menu-projects" aria-expanded="false">
<svg><use href="/assets/img/icons.svg#icon-user"></use></svg>Personal
                    </button>
<ul id="menu-personal">
<li class="nav-li"><a href="/cv">CV</a></li>
<li class="nav-li"><a href="/gallery">Gallery</a></li>
</ul>
</li>
<li class="nav-drop">
<button aria-controls="menu-projects" aria-expanded="false">
<svg><use href="/assets/img/icons.svg#icon-project"></use></svg>Projects
                    </button>
<ul id="menu-projects">
<li class="nav-li"><a href="/library/rfcd">RFCD</a></li>
<li class="nav-li"><a href="/tools/phyopt">phyopt</a></li>
<li class="nav-li"><a href="/tools/mtsdesc">mtsdesc</a></li>
</ul>
</li>
</ul>
</nav>
</header><main class="rssite-rspkgdown" id="rssite-main"><main id="rspkgdown-main"><nav aria-label="Site navigation" class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light"><div class="container">
<a class="navbar-brand me-2" href="../index.html">phyopt</a>
<small class="nav-text text-muted me-auto" data-bs-placement="bottom" data-bs-toggle="tooltip" title="">0.0.0.9000</small>
<button aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbar" data-bs-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse ms-3" id="navbar">
<ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
<button aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown-articles" type="button">Articles</button>
<ul aria-labelledby="dropdown-articles" class="dropdown-menu">
<li><a class="dropdown-item" href="../articles/example.html">Using the Phy Algorithm</a></li>
<li><a class="dropdown-item" href="../articles/theoretical_framework.html">Theoretical Framework</a></li>
</ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
</ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
<input aria-label="Search site" autocomplete="off" class="form-control" data-search-index="../search.json" id="search-input" name="search-input" placeholder="Search for" type="search"/>
</form></li>
<li class="nav-item"><a aria-label="GitHub" class="nav-link" href="https://github.com/ricardo-semiao/phyopt/"><span class="fa fab fa-github fa-lg"></span></a></li>
</ul>
</div>
</div>
</nav><div class="container template-quarto">
<div class="row">
<main class="col-md-9" id="main"><div class="page-header">
<h1>Theoretical Framework</h1>
<small class="dont-index">Source: <a href="https://github.com/ricardo-semiao/phyopt/blob/HEAD/vignettes/theoretical_framework.qmd"><code>vignettes/theoretical_framework.qmd</code></a></small>
<div class="d-none name"><code></code></div>
</div>
<section class="section level2"><h2 id="introduction">Introduction<a aria-label="anchor" class="anchor" href="#introduction"></a>
</h2>
<p>In this article, I present the motivation and the theoretical framework behind the <code>phyopt</code> package. See also the <code><a href="../articles/example.html">vignette("example", package = "phyopt")</a></code> article for a practical example and an implementation explanation of the algorithm.</p>
<p>There is a literature on the use of <em>hybrid optimization methods</em> that use two stages to first deal with complex aspects of the problem and then solve the remaining simpler problem with more efficient methods.</p>
<p>I focus on hybrid methods with a random first step, as they provide space for custom operators, possibly based on heuristics. This flexibility is important to solve non-standard problems.</p>
<p>I’ll start by describing the problems of interest and rewriting all of them in the same language in section <a class="quarto-xref" href="#sec-theory">Section 2</a>. With this general framing, I’ll describe the method’s design in section <a class="quarto-xref" href="#sec-design">Section 3</a>, and the essence of its coding implementation in <a class="quarto-xref" href="#sec-implementation">Section 4</a>.</p>
</section><section class="section level2"><h2 id="sec-theory">Theoretical Framework<a aria-label="anchor" class="anchor" href="#sec-theory"></a>
</h2>
<section class="level2"><h3 id="considered-problems-and-examples">Considered Problems and Examples<a aria-label="anchor" class="anchor" href="#considered-problems-and-examples"></a>
</h3>
<p>I’ll consider three types of ‘bad behaviors’: non-real variable domains (integer, categorical, etc.); variables that affect the objective or constraints functions in a complex (non-linear) way; and endogenous structure – problems where the structure of the problem is part of the optimization choice (e.g., the objective function or its domain can be chosen).</p>
<section class="level3"><h4 id="different-natures-of-variables">Different Natures of Variables<a aria-label="anchor" class="anchor" href="#different-natures-of-variables"></a>
</h4>
<p>Also consider variables with separable characteristics: some imply a clear global optimum and others don’t – <span class="math inline">\((x + \sin(2y))\)</span>; or where some are convex and others aren’t – <span class="math inline">\((x^2 + \text{floor}(x)^2)\)</span>; or some have ‘difficult’ constraints and others don’t.</p>
<p>I use examples from economics, but the context does not really matter; the mathematical characteristics that are important.</p>
</section><section class="level3"><h4 id="non-real-valued-variables">Non Real-Valued Variables<a aria-label="anchor" class="anchor" href="#non-real-valued-variables"></a>
</h4>
<p>Consider a central planner choosing lump-sum taxes <span class="math inline">\(\tau\)</span> to maximize some social welfare function. The higher the tax, the higher the government’s utility, and smaller the population’s <span class="math inline">\(i \in \{1, 2, \dots, N\}\)</span>.</p>
<p><span class="math display">\[
\begin{array}{lr}
    \max_{\tau} u(\tau) = U_G(\tau) + \sum_{i = 1}^N U_P^i(\tau), &amp;
    u: \mathbb{R}^+ \to \mathbb{R}
\end{array}
\]</span></p>
<p>Let’s add difficulty in steps. Considering the discrete nature of money, we have a mixed-integer problem:</p>
<p><span class="math display">\[
\begin{array}{lr}
    \max_{\tau} u(\tau) = U_G(\tau) + \sum_{i = 1}^N U_P^i(\tau), &amp;
    u: [0.01, 0.02, \dots] \to \mathbb{R}
\end{array}
\]</span></p>
<p>Suppose the government can choose different taxes <span class="math inline">\(\tau_s\)</span> given each person’s group <span class="math inline">\(s_i \in \{A, B\}\)</span>. Then, our problem is now mixed with a categorical variable:</p>
<p><span class="math display">\[
\begin{array}{lr}
  \max_{\tau, s} u(\tau, s) = U_G(\tau, s) + \sum_{i = 1}^N U_P^i(\tau_i(s_i)), &amp;
  u: (\mathbb{R}^+)^2 \times \{A, B\}^N \to \mathbb{R}\\
  \tau_i(s_i) = I\{s_i = A\}\tau_A + I\{s_i = B\}\tau_B &amp;
\end{array}
\]</span></p>
</section><section class="level3"><h4 id="endogenous-structure">Endogenous Structure<a aria-label="anchor" class="anchor" href="#endogenous-structure"></a>
</h4>
<p>What if the central planner, before choosing <span class="math inline">\(\tau\)</span>, must commit to it being in some interval <span class="math inline">\([\underline{\tau}, \underline{\tau} + c]\)</span>, <span class="math inline">\(c \in \mathbb{R}\)</span>? Or perhaps the number of groups can be chosen, such that <span class="math inline">\(s \in \{A, B\}\)</span> or <span class="math inline">\(\{A, B, C\}\)</span>, …?</p>
<p><span class="math display">\[
\begin{array}{lr}
  \max_{\tau, S, \mathcal{S}} u(\tau, S) = U_G(\tau, S) + \sum_{i = 1}^N U_P^i(\tau_i(S_i)), &amp;
  u: (\mathbb{R}^+)^2 \times \mathcal{S}^N \to \mathbb{R}\\
  \max_{\tau, \underline{\tau}} u(\tau), &amp;
  u: [\underline{\tau}, \underline{\tau} + c] \to \mathbb{R}
\end{array}
\]</span></p>
<p>Additionally, consider the researcher’s problem: they have data on <span class="math inline">\(\tau\)</span> and <span class="math inline">\(u(\tau; \theta)\)</span> and want to estimate some parameter <span class="math inline">\(\theta\)</span> by minimizing some loss function <span class="math inline">\(L(\theta; y - u(\tau; \theta))\)</span>. They do not know the scale of the abstract parameter <span class="math inline">\(\theta\)</span> but must choose a domain for their computational method.</p>
<p><span class="math display">\[
\begin{array}{lr}
  \min_{\theta, \Theta} L(\theta; y - u(\tau; \theta)), &amp;
  L: \Theta \to \mathbb{R}
\end{array}
\]</span></p>
<p>While this formulation could be interesting, it is not fundamentally different from using a general domain and creating a new constraint <span class="math inline">\(x \in \{\underline{\tau}, \underline{\tau} + c\}\)</span>. Similar manipulations could be done if the endogeneity of the structure were in a set of objective function options.</p>
</section></section><section class="level2"><h3 id="reframing-the-problems">Reframing the Problems<a aria-label="anchor" class="anchor" href="#reframing-the-problems"></a>
</h3>
<p>Consider below the general problem of optimizing a real-value function, with possibly non-real domain. I’ll show alterations that can be done to transform it into a generalist problem, aligned with hybrid methods.</p>
<p><span class="math display">\[
\begin{array}{lr}
  \max_{x, X} f(x) ~~s.t.~~ g(x) \geq 0, &amp;
  f: X \to \mathbb{R}^n,~ g: X \to \mathbb{R}^m,~ X \in \mathcal{X}
\end{array}
\]</span></p>
<p>Where: the domain is endogenous with options in <span class="math inline">\(\mathcal{X}\)</span>; <span class="math inline">\(n, m \in \mathbb{N}\)</span> are the dimensions of the result and constraints, respectively; the restrictions can be irrelevant <span class="math inline">\(g(x) = 0\)</span>; and not all dimensions of <span class="math inline">\(x\)</span> need to be used in both <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span>.</p>
<p>First, note that we can always separate, from the full <span class="math inline">\(x\)</span>, the variables <span class="math inline">\(\tilde{x}\)</span> to be worked only on the first step. If some constraints depend only on <span class="math inline">\(\tilde{x}\)</span>, we can separate them into <span class="math inline">\(\tilde{g}(\tilde{x})\)</span>.</p>
<p>Additionally, we can map the domain options <span class="math inline">\(\mathcal{X}\)</span> into a set of indexes <span class="math inline">\(\tilde{X}\)</span>. Then, we can rewrite our problem as choosing the index:</p>
<p><span class="math display">\[
\begin{array}{lr}
  \max_{x, \tilde{x}} f(x) ~~s.t.~~ g(x) \geq 0, &amp;
  f: X_{\tilde{x}} \to \mathbb{R}^n,~ g: X_{\tilde{x}} \to \mathbb{R}^{m},~ \tilde{x} \in \tilde{X}
\end{array}
\]</span></p>
<p>Based on the equivalence below, we can change the domain options <span class="math inline">\(\mathcal{X}\)</span> into restriction options <span class="math inline">\(H_{\mathcal{X}}\)</span>. Then, we can trade the domain choosing for the constraint <span class="math inline">\(g_{m+1}\)</span>:</p>
<p><span class="math display">\[
\begin{array}{c}
  x \in X ~~\Leftrightarrow~~ h(x) \geq 0,~ h: X = \{x: h(x) \geq 0\}\\
  H_{\mathcal{X}} = \{h_{\tilde{x}}: X = \{x: h_{\tilde{x}}(x) \geq 0\},~ X \in \mathcal{X}\}\\
  g_{m+1}(x, \tilde{x}) = \sum_{i \in \tilde{X}} I\{i = \tilde{x}\}h_{\tilde{x}}(x)
\end{array}
\]</span></p>
<p>Where if <span class="math inline">\(\mathcal{X}\)</span> is uncountable, <span class="math inline">\(\tilde{X} \subseteq \mathbb{R}\)</span> and we would use an integral.</p>
<p>After these manipulations, the reframed problem becomes:</p>
<p><span class="math display">\[
\begin{array}{lr}
    \max_{x, \tilde{x}} f(x, \tilde{x}) ~~s.t.~~ g(x, \tilde{x}) \geq 0,~ \tilde{g}(\tilde{x}) \geq 0, &amp;
    f: X \to \mathbb{R}^n,~ g: X \times \tilde{X} \to \mathbb{R}^{m},~ \tilde{g}: \tilde{X} \to \mathbb{R}^{\tilde{m}}
\end{array}
\]</span></p>
<p>As <span class="math inline">\(X \subseteq \mathbb{R}^k\)</span> is not open and <span class="math inline">\(g: X \rightarrow \mathbb{R}^m\)</span> is not differentiable, KKT conditions are not satisfied. Thus, I’ll describe a method for such problems in the next section.</p>
</section></section><section class="section level2"><h2 id="sec-design">Method Design<a aria-label="anchor" class="anchor" href="#sec-design"></a>
</h2>
<p>First, define the number <span class="math inline">\(T \in \mathbb{N}\)</span> of iterations (denoted by <span class="math inline">\(t\)</span>) and the number <span class="math inline">\(N \in \mathbb{N}\)</span> of samples (denoted by <span class="math inline">\(s\)</span>) in each population <span class="math inline">\(S_t\)</span>. Denote this step by <span class="math inline">\(S_0 = \text{init}(\tilde{X}, \tilde{g})\)</span>.</p>
<section class="level2"><h3 id="first-step-create-initial-sample-of-tildex">First Step: Create Initial Sample of <span class="math inline">\(\tilde{x}\)</span>
<a aria-label="anchor" class="anchor" href="#first-step-create-initial-sample-of-tildex"></a>
</h3>
<p>The first step is to create an initial population of the separated variables <span class="math inline">\(\tilde{x}\)</span>, <span class="math inline">\(S_0 = (\tilde{x}_s)_{s = 1}^N\)</span>. This population must be created to respect the constraints of <span class="math inline">\(\tilde{g}\)</span>. Denote this step by <span class="math inline">\(S_0 = \text{initialize}(\tilde{X}, \tilde{g})\)</span>.</p>
<p>There are several methods to create an initial sample. They generally can be divided into:</p>
<ul>
<li>Sampling <span class="math inline">\(\tilde{x}_s \sim P(.)\)</span> from a distribution <span class="math inline">\(P: \tilde{X} \to [0,1]\)</span>.
<ul>
<li>One can use the uniform distribution, or a heuristic guess based on knowledge of the problem, a-la importance sampling.</li>
</ul>
</li>
<li>Creating an even grid of points via some rule <span class="math inline">\(r\)</span> <span class="math inline">\(\tilde{x}_s = \inf\{\tilde{X}\} + r(\tilde{X})\)</span>.
<ul>
<li>Examples are grid sampling, Latin Hypercube sampling, Kronecker sampling, and Sobol or Halton sequences.</li>
</ul>
</li>
<li>Additionally, the domain can be split into groups and sampling done within each group (stratified/cluster-based sampling).</li>
</ul>
<p>The main goal is to guarantee that the algorithm will be able to explore the whole domain. Kazimipour et. al. <a href="https://doi.org/10.1109/CEC.2014.6900618">(2014)</a> provides a comprehensive review of initialization methods.</p>
<p>Then, to guarantee validity of the <span class="math inline">\(\tilde{g}\)</span> constraints, there are several methods:</p>
<ul>
<li>Rejecting or repairing samples that break the constraints.
<ul>
<li>Using the closest valid point, some projection into the valid space, amongst others.</li>
</ul>
</li>
<li>Using heuristics to sample only from the valid space.
<ul>
<li>Sampling each dimension of <span class="math inline">\(\tilde{x}_s\)</span> at a time, updating the valid space of the rest each time; choosing a distribution <span class="math inline">\(P\)</span> that is more likely to sample valid points; amongst others.</li>
</ul>
</li>
</ul>
<p>Note that if <span class="math inline">\(\tilde{x}\)</span> contains encoded variables, as in the Researcher’s Problem, any heuristics used depend on how the encoding was done.</p>
</section><section class="level2"><h3 id="second-step-solve-the-reduced-problem">Second Step: Solve the Reduced Problem<a aria-label="anchor" class="anchor" href="#second-step-solve-the-reduced-problem"></a>
</h3>
<p>Denote this step by <span class="math inline">\(R_t = \text{optimize}(X, g, t, S_t)\)</span>. For a given sample <span class="math inline">\(\tilde{x}_s\)</span>, what is left is the reduced problem, that doesn’t depend on <span class="math inline">\(\tilde{x}\)</span> nor <span class="math inline">\(\tilde{g}\)</span>:</p>
<p><span class="math display">\[
\begin{array}{lr}
  \max_{x} f_s(x;~ \tilde{x}_s) ~~s.t.~~ g_s(x;~ \tilde{x}_s) \geq 0, &amp;
  f: X \to \mathbb{R}^n,~ g: X \to \mathbb{R}^m
\end{array}
\]</span></p>
<p>One chooses the solver of their liking to this problem. One can also choose several options, that get randomly picked for each sample, which helps with generality of the solution.</p>
<p>Then, for each <span class="math inline">\(\tilde{x}_s \in S_t\)</span>, the problem is solved into <span class="math inline">\(x_s^*\)</span>, and an ordered set of the results - and optional meta-information <span class="math inline">\(I_s\)</span> (e.g.: time to completion) - are stored:</p>
<p><span class="math display">\[
\begin{array}{lr}
  O_s = (\tilde{x}_s,~ x^*_s,~ f(x^*_s, \tilde{x}_s),~ I_s), &amp;
  R_t = (O_s)_{s = 1}^N
\end{array}
\]</span></p>
<p>A set of metrics <span class="math inline">\(M_t\)</span> is calculated from <span class="math inline">\(R_t\)</span>. Then the stopping criteria can be drawn from a combination of options. On top of maximum time elapsed or iterations, one can consider the best/median/other sample value <span class="math inline">\((\tilde{x}, x)\)</span> or performance <span class="math inline">\(f((\tilde{x}, x))\)</span> (denote by <span class="math inline">\(o\)</span>), via: threshold <span class="math inline">\(o \gtrless k\)</span>; convergence <span class="math inline">\(|o_{t'} - o_t| &lt; \epsilon\)</span>; or stability <span class="math inline">\(sd(o) &lt; \epsilon\)</span>. Let <span class="math inline">\(R = (R_t)_{t = 1}^T\)</span> and <span class="math inline">\(M = (M_t)_{t = 1}^T\)</span>.</p>
</section><section class="level2"><h3 id="third-step-update-the-sample">Third Step: Update the Sample<a aria-label="anchor" class="anchor" href="#third-step-update-the-sample"></a>
</h3>
<p>The last step is to update the sample: <span class="math inline">\(S_{t+1} = \text{update}(\tilde{X}, \tilde{g}, t, S_t, R_t)\)</span>. The general objective is to create a new population in the “direction” of the best performing samples in <span class="math inline">\(S_t\)</span>. There are many literatures that motivate <span class="math inline">\(\text{update}\)</span> operators, and it will be user-supplied in the coding implementation, such that the setup can encompass many options.</p>
<p>For the present explanation, I’ll focus on operators that are more easily applied to numeric problems in economics, mainly related to the Evolutionary Algorithms literature. Consider the option of combining random tuples of samples (“crossover”), and then adding some randomization, to avoid local optima (“mutation”). In simplistic terms, a ‘child’ sample is created by:</p>
<ul>
<li>Position crossover: taking some positions/dimensions from each of the ‘parents’, randomly.</li>
<li>Arithmetic crossover: combining the parents’ values, with averages or else.</li>
<li>Distributional crossover: sampling from a distribution based on the parents’ values.</li>
<li>Resample mutation: randomly choosing a dimension to resample from its distribution.</li>
<li>Noise mutation: randomly choosing a dimension to add noise.</li>
<li>The amount of crossover and mutation, amongst others, can be hyperparameters, which can even depend on the iteration <span class="math inline">\(t\)</span>.</li>
</ul>
<p>Again, not remotely an exhaustive list. More on crossover and mutation can be found in Kora and Yadlapalli <a href="https://doi.org/10.5120/ijca2017913370">(2017)</a>, De Falco et. al. <a href="https://doi.org/10.1016/S1568-4946(02)00021-2">(2002)</a>, but many other random optimization literatures can be considered.</p>
<p>Note that these operators need to account for possibly non-real or non-numeric variables, and also for the constraints <span class="math inline">\(\tilde{g}\)</span>. The flexibility of being able to define the operator is a major advantage of the method.</p>
</section></section><section class="section level2"><h2 id="sec-implementation">Coding Implementation<a aria-label="anchor" class="anchor" href="#sec-implementation"></a>
</h2>
<p>It is unfeasible to explain all the details of the implementation here, but all is explained in the package’s documentation.</p>
<p>The main function is <code><a href="../reference/optimize_phy.html">optimize_phy()</a></code>. It, and all others, have documentation pages with the same math notation as here, and with similar argument names (e.g.: <code>xtil</code> for <span class="math inline">\(\tilde{x}\)</span> and <code>x_dom</code> for <span class="math inline">\(X\)</span>). The function receives the main arguments:</p>
<ul>
<li>The functions <code>f</code>, <code>g</code>, <code>gtil</code>, which must receive the correct arguments <code>x</code> and/or <code>xtil</code>.</li>
<li>The domains <code>x_dom</code>, <code>xtil_dom</code>, lists with length <span class="math inline">\(m\)</span> and <span class="math inline">\(\tilde{m}\)</span>. Will be used by the user-supplied operators and their elements can be whatever the user needs.</li>
<li>The operators <code>initializer</code>, <code>optimizer</code>, and <code>updater</code>, which must receive the arguments described in the previous section, and return an output in a specific format.</li>
<li>The helper <code>stopper</code>, that calculates metrics of the performance at each iteration, and sets the stopping criteria; and <code>logger</code>, that logs the performance to the console for user feedback. They are created by the helper functions <code><a href="../reference/flow_stopper.html">flow_stopper()</a></code> and <code><a href="../reference/flow_logger.html">flow_logger()</a></code>.</li>
</ul>
<p>The algorithm is presented below. The user-provided function calls are wrapped in the <code>try_op</code> function to catch and report errors in a user-friendly way. The notation <code>x\$y</code> indicates an object <span class="math inline">\(y\)</span> within an object <span class="math inline">\(x\)</span>.</p>
<p><img src="algorithm.png"/></p>
<p>It is very important to read the “Using the Phy Algorithm” vignette <code><a href="../articles/example.html">vignette("example", package = "phyopt")</a></code>, which thoroughly explains the package logic and usage. At its core, the package wraps the operators into a two-step hybrid procedure. The user is responsible for making smart choices for these operators, but the package guarantees (i) thorough tests and error handling to help debugging, and (ii) a flexible, generalist, agnostic setup that does not restrict the user. The tricks to allow (i) any size of <span class="math inline">\(m\)</span> and <span class="math inline">\(\tilde{m}\)</span>; (ii) any kind of operator; and (iii) any kind of metric <span class="math inline">\(M_t\)</span> and stopping criteria are especially important.</p>
</section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav aria-label="Table of contents" id="toc"><h2>On this page</h2>
</nav></aside>
</div>
</div>
</main></main><footer id="rssite-footer"><p>
            Package made with <a href="https://pkgdown.r-lib.org/">pkgdown</a><span class="footer-div"></span><a href="https://github.com/ricardo-semiao/ricardo-semiao/tree/main/themes/rspkgdown">rspkgdown</a> theme.</p>
</footer><button aria-controls="pkgdown-navbar" aria-hidden="true" aria-label="Show package navbar" id="show-navbar"></button>
<button aria-hidden="true" id="back-to-top" onclick="window.scrollTo(0, 0); return false;">
<span>↑</span> Back to top
    </button><script src="/assets/global.js"></script>
<script src="assets/rspd_module.js"></script>
</body>
</html>
